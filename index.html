<script>
  async function loadScores() {
    const response = await fetch("https://script.google.com/macros/s/AKfycbzyWVzWFVFUwHbBe_UhD7hKkM2WmJKfHSYOwt8oJa7FTCx_-SqCbo2fwAQ9qqJ8BIFc/exec");
    const data = await response.json();

    const scoreboard = document.getElementById("scoreboard");
    scoreboard.innerHTML = "";

    const divisions = ["Stars", "Stripes"];

    divisions.forEach(division => {
      const section = document.createElement("div");

      const heading = document.createElement("h2");
      heading.textContent = division;
      heading.style.fontSize = "14px";
      heading.style.marginBottom = "4px";
      section.appendChild(heading);

      const table = document.createElement("table");
      table.style.marginBottom = "10px";
      table.style.fontSize = "11px";
      table.style.borderCollapse = "collapse";

      // Background color by division
      if (division === "Stars") {
        table.classList.add("table-stars");
      } else if (division === "Stripes") {
        table.classList.add("table-stripes");
      }

      // ðŸ‘‡ NEW: Add <colgroup> to control column widths precisely
      const colgroup = document.createElement("colgroup");
      ["50%", "5%", "5%", "5%"].forEach(width => {
        const col = document.createElement("col");
        col.style.width = width;
        colgroup.appendChild(col);
      });
      table.appendChild(colgroup);

      // Header row
      const header = document.createElement("tr");
      ["Match", "Ends", "", ""].forEach((text, index) => {
        const th = document.createElement("th");

        if (index === 2) {
          th.textContent = "";
          th.className = "score-header-red";
        } else if (index === 3) {
          th.textContent = "";
          th.className = "score-header-blue";
        } else if (text === "Ends") {
          th.textContent = "Ends";
          th.className = "ends";
        } else {
          th.textContent = text;
          th.style.background = "#eee";
        }
        header.appendChild(th);
      });
      table.appendChild(header);

      // Match rows
      data.filter(row => row.division === division).forEach(row => {
        const tr = document.createElement("tr");

        const matchCell = document.createElement("td");
        matchCell.textContent = row.match;
        matchCell.className = division === "Stars" ? "match-women womens" : "match-men mens";
        tr.appendChild(matchCell);

        const endsCell = document.createElement("td");
        endsCell.textContent = row.ends;
        endsCell.className = "ends";
        tr.appendChild(endsCell);

        const score1 = document.createElement("td");
        score1.textContent = row.score1;
        score1.style.color = "red";
        tr.appendChild(score1);

        const score2 = document.createElement("td");
        score2.textContent = row.score2;
        score2.style.color = "blue";
        tr.appendChild(score2);

        table.appendChild(tr);
      });

      section.appendChild(table);
      scoreboard.appendChild(section);
    });
  }

  loadScores();
  setInterval(loadScores, 10000);
</script>
